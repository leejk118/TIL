# 7. 데이터베이스 마이그레이션

> 데이터베이스 마이그레이션이란 테이블 스키마의 버전 관리

> 테이블에 새로운 열을 추가한다든지, 열 이름을 바꾼다든지 하는 이력을 마이그레이션 코드로 남겨 두고 필요할 때마다 마이그레이션을 실행했다가 롤백하는 등의 작업을 자유롭게 할 수 있다.

* 마이그레이션은 왜 필요?
  * 팀 내 개발자들은 같은 데이터베이스 스키마로 개발해야 함
  * 한 개발자의 스키마 변경을 다른 개발자도 사용해야 함
  * 개발 환경뿐 아니라 테스트 서버, 지속적 통합 서버, 운영 서버 등에서 환경을 쉽고 빠르게 만들 수 있는 도구 필요
  * 비지니스는 계속 변하고, 요구 사항도 계속 변한다.



### 마이그레이션 만들기

> 이전에 만든 테이블 삭제하기
>
> mysql>
>
> use myapp;
>
> SET FOREIGN_KEY_CHECKS=0;
>
> DROP TABLE posts;
>
> DROP TABLE authors;
>
> SET FOREIGN_KEY_CHECKS=1;

> 외래 키가 걸려 있을 때를 대비해 오류 방지하기 위한 습관



* 마이그레이션 클래스 뼈대 코드 생성

  `php artisan make:migration create_posts_table --create=posts`

  `php artisan make:migration create_authors_table --create=authors`

  * 생성된 파일은 database/migrations 디렉토리 아래에 있다.

    > 두 개는 라라벨에 기본으로 포함된 마이그레이션

  * 마이그레이션 파일 이름

    * 관례적으로 스네이크 표기법 사용
    * `create_`, `make_`, `add_`, `drop_`, `change_` 등으로 시작하고, `_table`로 끝난다.
    * 둘 사이에는 마이그레이션을 설명할 수 있는 내용을 기술

